<script src="https://cdnjs.cloudflare.com/ajax/libs/cloudinary-core/2.3.0/cloudinary-core-shrinkwrap.min.js"></script>
{{ $icons := resources.Get "js/icons.bundle.js" }}
{{ $main := resources.Get "js/main.js" }}
{{ $js := slice $icons $main | resources.Concat "js/bundle.js" }}

{{ with $js }}
{{ $secureJS := . | resources.Fingerprint }}
<script type="text/javascript" src="{{ $secureJS.Permalink }}" integrity="{{ $secureJS.Data.Integrity }}"
    crossorigin="anonymous" defer></script>
{{ end }}




{{- if eq (getenv "HUGO_ENV") "production" | or (eq $.Site.Params.env "production") -}}
<script>
    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function(registration) {
                console.log('Service Worker Registered');
            });

        navigator.serviceWorker
            .ready
            .then(function(registration) {
                console.log('Service Worker Ready');
            });
    }
</script>
{{ end }}