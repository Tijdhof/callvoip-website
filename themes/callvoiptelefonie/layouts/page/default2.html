{{ define "main" }}
<article class="mb-8 md:mb-0">
  {{ $shopSec := .Site.GetPage "/program-shop" }}
  {{ with .Params.marketplaceitem }}
  <div class="bg-grey-lightest">
      <dialog id="dialog" class="z-50 w-full h-full">
        <form name="crm-info" action="/bedank/crm-demo/" accept-charset="UTF-8" method="POST" data-netlify-honeypot="true" data-netlify="true"
          class="max-w-screen-sm bg-white p-8 rounded-lg shadow-xl relative mx-auto">
         
          <p class="hidden">
            <input type="hidden" name="CRM Item" value="makelaars-crm" />
            <label>Don’t fill this out if human <input name="bot-field"> </label>
            <input type="hidden" id="formlayout" name="formlayout" value="d-126942c712c44ec98eb3f158d6b2c826">
            <input type="hidden" id="formto" name="formto" value="offerte" class="hidden">
          </p>

          <h3 class="text-2xl">Informatie over de CRM koppeling en demo ontvangen?</h3><br>

          <div class="space-y-4">
            <div class="space-y-2 flex flex-col">
              <label for="Bedrijfsnaam">Naam</label>
              <input name="Bedrijfsnaam" required class="w-full bg-grey-lightest rounded-full p-3">
            </div>
            <div class="space-y-2 flex flex-col">
              <label for="Email">Email</label>
              <input type="email" name="Email" required class="w-full bg-grey-lightest rounded-full p-3">
            </div>
            <div class="space-y-2 flex flex-col">
              <label for="Telefoonnummer">Telefoonnummer</label>
              <input type="tel" name="Telefoonnummer" required class="w-full bg-grey-lightest rounded-full p-3">
            </div>
            <p>
              <button class="w-full p-3 bg-blue text-white rounded-full">Versturen</button>
              <small>Gegevens worden gebruikt om éénmalig contact met je op te nemen.</small>
            </p>
          </div>
          <button type="button" onclick="dialog.close();" class="absolute top-0 right-0 text-3xl leading-none mr-2 text-red">×</button>
        </form>
      </dialog>
    <div class="mx-auto p-4 md:p-8 container px-0 lg:mt-8">
      <div class="flex items-start space-x-2 md:space-x-4">
        <a href="{{$shopSec.Permalink}}"
          class="py-2 md:py-4 p-4 rounded-lg bg-grey-dark shadow-md text-white whitespace-no-wrap">
          <span class="hidden md:inline">Naar Marketplace</span>
        </a>
        <div class="relative w-full">
          <input type="text" placeholder="Zoek binnen de Callvoip Marketplace..." id="search_input"
            class="w-full focus:outline-none bg-white shadow-md rounded-lg py-2 md:py-4 p-4 relative z-30">
          <div class="absolute z-30 w-full">
            <ul class="bg-white shadow-lg" id="search_result">
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  {{$searchFile := $shopSec.OutputFormats.Get "json" }}
  <script>
    function Get(yourUrl) {
      var Httpreq = new XMLHttpRequest();
      Httpreq.open("GET", yourUrl, false);
      Httpreq.send(null);
      return Httpreq.responseText;
    }
    function search(source, name) {
      var results = [],
        index,
        entry;

      name = name.toUpperCase();
      for (index = 0; index < source.length; ++index) {
        entry = source[index];
        if (entry && entry.title && entry.title.toUpperCase().indexOf(name) !== -1) {
          results.push(entry);
        }
      }
      return results;
    }

    var json_obj = JSON.parse(Get('{{$searchFile.Permalink }}'));

    var input = document.getElementById("search_input"),
      rlist = input.nextElementSibling.querySelector('ul');

    input.addEventListener("keyup", function (e) {
      rlist.innerHTML = ''
      if (input.value.length > 0) {
        var result = search(json_obj, input.value);
        result.forEach(e => {
          var newli = document.createElement('li');
          newli.innerHTML = '<a href=\"' + e.url + '\" class="p-4 hover:bg-grey-lightest block capitalize">' + e.title + '</a>';
          rlist.appendChild(newli)
        })
      }
    });
  </script>
  {{- end }}
  {{- partial "components/page-hero2.html" . -}}
  {{- partial "components/double-content.html" . -}}
  {{- partial "components/content-blocks2.html" . -}}
  {{- partial "components/page-intro-top.html" . -}}
  {{- partial "components/text-blocks-footer.html" . -}}
  {{- partial "components/textblocksfooter2.html" . -}}
  {{- partial "components/extracontent.html" . -}}
  {{- partial "components/text-blocks2.html" . -}}
  {{- partial "components/usp-kit.html" . -}}
  {{- partial "components/logos2.html" . -}}
  {{- partial "components/prijzen.html" . -}}
  {{- partial "components/white-footer.html" . -}}
  {{- partial "components/page-intro.html" . -}}
  {{- partial "components/bottom.html" . -}}
  {{- partial "components/user-content.html" . -}}
</article>
{{ end }}
